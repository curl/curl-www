GSS delegation too eager connection reuse
=========================================

Project curl Security Advisory, March 20th 2023 -
[Permalink](https://curl.se/docs/CVE-2023-27536.html)

VULNERABILITY
-------------

libcurl would reuse a previously created connection even when the GSS
delegation (`CURLOPT_GSSAPI_DELEGATION`) option had been changed that could
have changed the user's permissions in a second transfer.

libcurl keeps previously used connections in a connection pool for subsequent
transfers to reuse if one of them matches the setup. However, this GSS
delegation setting was left out from the configuration match checks, making
them match too easily, affecting krb5/kerberos/negotiate/GSSAPI transfers.

INFO
----

CWE-305: Authentication Bypass by Primary Weakness

Severity: Low

AFFECTED VERSIONS
-----------------

- Affected versions: curl 7.22.0 to and including 7.88.1
- Not affected versions: curl < 7.22.0 and curl >= 8.0.0
- Introduced-in: https://github.com/curl/curl/commit/ebf42c4be76df4

libcurl is used by many applications, but not always advertised as such!

SOLUTION
------------

- Fixed-in: https://github.com/curl/curl/commit/cb49e67303dba

RECOMMENDATIONS
--------------

 A - Upgrade curl to version 8.0.0

 B - Apply the patch to your local version

 C - Do not use the `CURLOPT_GSSAPI_DELEGATION` option

TIMELINE
--------

This issue was reported to the curl project on March 7, 2023. We contacted
distros@openwall on March 13, 2023.

curl 8.0.0 was released on March 20 2023, coordinated with the publication of
this advisory.

CREDITS
-------

- Reported-by: Harry Sintonen
- Patched-by: Daniel Stenberg

Thanks a lot!
