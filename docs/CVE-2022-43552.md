HTTP Proxy deny use after free
==============================

Project curl Security Advisory, December 21 2022 -
[Permalink](https://curl.se/docs/CVE-2022-43552.html)

VULNERABILITY
-------------

curl can be asked to *tunnel* virtually all protocols it supports through an
HTTP proxy. HTTP proxies can (and often do) deny such tunnel operations using
an appropriate HTTP error response code.

When getting denied to tunnel the specific protocols SMB or TELNET, curl would
use a heap-allocated struct after it had been freed, in its transfer shutdown
code path.

INFO
----

This flaw was introduced for TELNET in September 7, 2006. The SMB part was
introduced in 2014.

The Common Vulnerabilities and Exposures (CVE) project has assigned the name
CVE-2022-43552 to this issue.

CWE-416: Use After Free

Severity: Low

AFFECTED VERSIONS
-----------------

- Affected versions: curl 7.16.0 to and including 7.86.0
- Not affected versions: curl < 7.16.0 and curl >= 7.87.0
- Introduced-in: https://github.com/curl/curl/commit/b7eeb6e67fca68

libcurl is used by many applications, but not always advertised as such!

SOLUTION
------------

- Fixed-in: https://github.com/curl/curl/commit/4f20188ac644afe17

RECOMMENDATIONS
--------------

 A - Upgrade curl to version 7.87.0

 B - Apply the patch to your local version

 C - Avoid using SMB and TELNET or disable HTTP proxy use

TIMELINE
--------

This issue was reported to the curl project on November 7, 2022. We contacted
distros@openwall on December 12, 2022.

curl 7.87.0 was released on December 21 2022, coordinated with the publication
of this advisory.

CREDITS
-------

- Reported-by: Trail of Bits
- Patched-by: Daniel Stenberg

Thanks a lot!
